import { NextResponse } from 'next/server';

// TODO: Replace with real database queries
// This is a placeholder that returns structured data matching the frontend types
export async function GET() {
  try {
    // In production, query your database (Firestore, Supabase, etc.)
    // Example: const courses = await db.collection('courses').where('status', '==', 'approved').get();
    
    const freeCourses = [
      {
        id: '1',
        title: 'Introduction to Islam',
        description: 'Perfect for beginners. Learn the five pillars and fundamental beliefs.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '2 weeks',
        lessons: 12,
        progressPercent: 0,
        enrolled: false,
        rating: 4.9,
        students: 15420,
        price: 0,
        status: 'approved',
      },
      {
        id: '2',
        title: 'Perfecting Your Salah',
        description: 'Master the prayer with detailed guidance on every movement and recitation.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '1 week',
        lessons: 8,
        progressPercent: 38,
        enrolled: true,
        rating: 4.8,
        students: 12350,
        price: 0,
        status: 'approved',
      },
      {
        id: '3',
        title: 'Understanding the Quran',
        description: 'Learn Tafsir basics and understand the meanings behind the verses.',
        category: 'Quran',
        difficulty: 'Intermediate',
        duration: '4 weeks',
        lessons: 20,
        progressPercent: 0,
        enrolled: false,
        rating: 4.9,
        students: 8920,
        price: 0,
        status: 'approved',
      },
      {
        id: '4',
        title: 'The Life of Prophet Muhammad ï·º',
        description: 'Detailed journey through the Seerah of our beloved Prophet.',
        category: 'History',
        difficulty: 'Beginner',
        duration: '6 weeks',
        lessons: 30,
        progressPercent: 0,
        enrolled: false,
        rating: 5.0,
        students: 18760,
        price: 0,
        status: 'approved',
      },
      {
        id: '8',
        title: 'Ramadan Preparation Guide',
        description: 'Prepare spiritually and practically for the blessed month of Ramadan.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '2 weeks',
        lessons: 10,
        progressPercent: 0,
        enrolled: false,
        rating: 4.7,
        students: 9340,
        price: 0,
        status: 'approved',
      },
      {
        id: '9',
        title: 'Tajweed Essentials',
        description: 'Learn the rules of Quranic recitation to beautify your reading.',
        category: 'Quran',
        difficulty: 'Beginner',
        duration: '3 weeks',
        lessons: 15,
        progressPercent: 0,
        enrolled: false,
        rating: 4.8,
        students: 7650,
        price: 0,
        status: 'approved',
      },
      {
        id: '10',
        title: 'Stories of the Prophets',
        description: 'Inspiring lessons from the lives of all the prophets mentioned in the Quran.',
        category: 'History',
        difficulty: 'Beginner',
        duration: '5 weeks',
        lessons: 25,
        progressPercent: 0,
        enrolled: false,
        rating: 4.9,
        students: 11230,
        price: 0,
        status: 'approved',
      },
      {
        id: '11',
        title: 'Islamic Manners & Etiquette',
        description: 'Learn the beautiful character traits taught by Islam.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '2 weeks',
        lessons: 10,
        progressPercent: 0,
        enrolled: false,
        rating: 4.6,
        students: 5890,
        price: 0,
        status: 'approved',
      },
      {
        id: '12',
        title: 'Introduction to Hadith Sciences',
        description: 'Understand the compilation and authentication of Prophetic traditions.',
        category: 'Fiqh',
        difficulty: 'Intermediate',
        duration: '4 weeks',
        lessons: 18,
        progressPercent: 0,
        enrolled: false,
        rating: 4.8,
        students: 4560,
        price: 0,
        status: 'approved',
      },
      {
        id: '13',
        title: 'Purification & Wudu Guide',
        description: 'Complete guide to physical and spiritual purification in Islam.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '1 week',
        lessons: 6,
        progressPercent: 0,
        enrolled: false,
        rating: 4.7,
        students: 8920,
        price: 0,
        status: 'approved',
      },
      {
        id: '14',
        title: 'Making Dua',
        description: 'Learn the etiquettes, times, and powerful supplications from Quran and Sunnah.',
        category: 'Basics',
        difficulty: 'Beginner',
        duration: '1 week',
        lessons: 7,
        progressPercent: 0,
        enrolled: false,
        rating: 4.9,
        students: 10450,
        price: 0,
        status: 'approved',
      },
      {
        id: '15',
        title: 'Memorization Techniques',
        description: 'Proven methods to memorize Quran efficiently and retain what you learn.',
        category: 'Quran',
        difficulty: 'Beginner',
        duration: '2 weeks',
        lessons: 8,
        progressPercent: 0,
        enrolled: false,
        rating: 4.8,
        students: 6780,
        price: 0,
        status: 'approved',
      },
    ];

    const specializedCourses = [
      {
        id: '5',
        title: 'Islamic Finance Fundamentals',
        description: 'Introduction to halal income, Riba, and Islamic economic principles.',
        category: 'Finance',
        difficulty: 'Intermediate',
        duration: '3 weeks',
        lessons: 15,
        progressPercent: 0,
        enrolled: false,
        rating: 4.7,
        students: 6540,
        price: 49,
        status: 'approved',
      },
      {
        id: '6',
        title: 'Advanced Fiqh Studies',
        description: 'Deep dive into Islamic jurisprudence and scholarly opinions.',
        category: 'Fiqh',
        difficulty: 'Advanced',
        duration: '8 weeks',
        lessons: 40,
        progressPercent: 0,
        enrolled: false,
        rating: 4.8,
        students: 2340,
        price: 99,
        status: 'approved',
      },
      {
        id: '7',
        title: 'Arabic for Quranic Understanding',
        description: 'Learn Quranic Arabic to understand the Quran in its original language.',
        category: 'Language',
        difficulty: 'Intermediate',
        duration: '12 weeks',
        lessons: 50,
        progressPercent: 0,
        enrolled: false,
        rating: 4.9,
        students: 4120,
        price: 79,
        status: 'pending_verification',
      },
      {
        id: '16',
        title: 'Complete Tafsir of Surah Al-Baqarah',
        description: 'Verse-by-verse explanation of the longest and most comprehensive Surah.',
        category: 'Quran',
        difficulty: 'Advanced',
        duration: '10 weeks',
        lessons: 45,
        price: 129,
        rating: 5.0,
        students: 2340,
        instructor: 'Sheikh Ismail Dockrat',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '17',
        title: 'Halal Investment Strategies',
        description: 'Practical guide to building a Shariah-compliant investment portfolio.',
        category: 'Finance',
        difficulty: 'Intermediate',
        duration: '5 weeks',
        lessons: 20,
        price: 89,
        rating: 4.6,
        students: 1560,
        instructor: 'Br. Ahmed Vawda',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '18',
        title: 'Islamic Marriage & Family Law',
        description: 'Understanding the rights, responsibilities, and rulings around marriage.',
        category: 'Fiqh',
        difficulty: 'Intermediate',
        duration: '4 weeks',
        lessons: 16,
        price: 59,
        rating: 4.8,
        students: 4230,
        instructor: 'Dr. Aisha Moosa',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '19',
        title: 'Business Ethics in Islam',
        description: 'Learn Islamic principles for conducting business with integrity.',
        category: 'Finance',
        difficulty: 'Intermediate',
        duration: '3 weeks',
        lessons: 12,
        price: 39,
        rating: 4.7,
        students: 2890,
        instructor: 'Sheikh Yunus Osman',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '20',
        title: 'Advanced Arabic Grammar',
        description: 'Master Nahw and Sarf to unlock deeper Quranic meanings.',
        category: 'Language',
        difficulty: 'Advanced',
        duration: '16 weeks',
        lessons: 60,
        price: 149,
        rating: 4.9,
        students: 980,
        instructor: 'Ustadh Ibrahim Hendricks',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '21',
        title: 'Islamic History: Golden Age',
        description: 'Explore the scientific, cultural, and political achievements of Muslim civilization.',
        category: 'History',
        difficulty: 'Intermediate',
        duration: '6 weeks',
        lessons: 24,
        price: 69,
        rating: 4.8,
        students: 3450,
        instructor: 'Dr. Zaynab Ravat',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
      {
        id: '22',
        title: 'Qira\'at: Seven Readings',
        description: 'Study the different authentic recitations of the Quran.',
        category: 'Quran',
        difficulty: 'Advanced',
        duration: '20 weeks',
        lessons: 80,
        price: 199,
        rating: 5.0,
        students: 567,
        instructor: 'Qari Yusuf Essack',
        enrolled: false,
        progressPercent: 0,
        status: 'approved',
      },
    ];

    const reflections = [
      {
        id: 'r1',
        title: 'Patience in Hardship',
        ayah: 'Indeed, Allah is with the patient.',
        reference: 'Quran 2:153',
        theme: 'Patience',
      },
      {
        id: 'r2',
        title: 'The Power of Gratitude',
        ayah: 'If you are grateful, I will surely increase you [in favor].',
        reference: 'Quran 14:7',
        theme: 'Gratitude',
      },
      {
        id: 'r3',
        title: 'Trust in Allah\'s Plan',
        ayah: 'And it may be that you dislike a thing which is good for you.',
        reference: 'Quran 2:216',
        theme: 'Trust',
      },
      {
        id: 'r4',
        title: 'Seeking Knowledge',
        ayah: 'Say, "My Lord, increase me in knowledge."',
        reference: 'Quran 20:114',
        theme: 'Knowledge',
      },
      {
        id: 'r5',
        title: 'Divine Mercy',
        ayah: 'And My mercy encompasses all things.',
        reference: 'Quran 7:156',
        theme: 'Mercy',
      },
      {
        id: 'r6',
        title: 'Remember Me',
        ayah: 'So remember Me; I will remember you.',
        reference: 'Quran 2:152',
        theme: 'Remembrance',
      },
      {
        id: 'r7',
        title: 'Relief After Hardship',
        ayah: 'Indeed, with hardship comes ease.',
        reference: 'Quran 94:6',
        theme: 'Hope',
      },
      {
        id: 'r8',
        title: 'The Best Speech',
        ayah: 'And who is better in speech than one who invites to Allah?',
        reference: 'Quran 41:33',
        theme: 'Dawah',
      },
      {
        id: 'r9',
        title: 'Guarding Your Prayer',
        ayah: 'Guard strictly your prayers, especially the middle prayer.',
        reference: 'Quran 2:238',
        theme: 'Prayer',
      },
      {
        id: 'r10',
        title: 'Sincere Worship',
        ayah: 'And they were not commanded except to worship Allah, [being] sincere to Him.',
        reference: 'Quran 98:5',
        theme: 'Sincerity',
      },
      {
        id: 'r11',
        title: 'Good Company',
        ayah: 'And keep yourself patient with those who call upon their Lord.',
        reference: 'Quran 18:28',
        theme: 'Companionship',
      },
      {
        id: 'r12',
        title: 'Victory of Truth',
        ayah: 'Truth has come, and falsehood has departed.',
        reference: 'Quran 17:81',
        theme: 'Truth',
      },
    ];

    const stripCourseMeta = (course: Record<string, unknown>) => {
      const { rating, students, instructor, ...rest } = course as {
        rating?: number;
        students?: number;
        instructor?: string;
        [key: string]: unknown;
      };
      return rest;
    };

    return NextResponse.json({
      freeCourses: freeCourses.map(stripCourseMeta),
      specializedCourses: specializedCourses.map(stripCourseMeta),
      reflections,
    });
  } catch (error) {
    console.error('Library API error:', error);
    return NextResponse.json(
      { error: 'Failed to load library data' },
      { status: 500 }
    );
  }
}
